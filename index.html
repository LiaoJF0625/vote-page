<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>即時投票系統（純網頁）</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    button { margin: 8px; padding: 10px 20px; font-size: 16px; }
    #chart-container { width: 400px; margin-top: 30px; }
  </style>
</head>
<body>

<h2>即時投票系統</h2>

<button onclick="vote('A')">投票 A</button>
<button onclick="vote('B')">投票 B</button>
<button onclick="vote('C')">投票 C</button>

<h3>目前票數（圓餅圖）：</h3>
<div id="chart-container">
  <canvas id="voteChart"></canvas>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  // <<< 在這貼你的 Firebase 設定 >>>
  const firebaseConfig = {
    apiKey: "YOUR_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT.firebaseio.com",
    projectId: "YOUR_PROJECT",
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // --- 投票功能 ---
  function vote(option) {
    db.ref("votes/" + option).transaction(count => {
      return (count || 0) + 1;
    });
  }

  // --- 圓餅圖 ---
  const ctx = document.getElementById("voteChart").getContext("2d");

  const voteChart = new Chart(ctx, {
    type: "pie",
    data: {
      labels: ["A", "B", "C"],
      datasets: [{
        data: [0, 0, 0]
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: "bottom" }
      }
    }
  });

  // --- 即時更新圖表 ---
  db.ref("votes").on("value", snapshot => {
    const v = snapshot.val() || {};
    voteChart.data.datasets[0].data = [
      v.A || 0,
      v.B || 0,
      v.C || 0
    ];
    voteChart.update();
  });
</script>

</body>
</html>
